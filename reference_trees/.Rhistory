library(TreeDist)
library(ape)
setwd("/Users/ekim/Desktop/compbio-project/trees")
jgi <- read.tree("JGItree.nwk")
aim1 <- read.tree("aim1.nwk")
aim2_all <- read.tree("all_samples.nhx")
aim2_jgi <- read.tree("jgi_backbone_aim2.nwk")
a3_10_9 <- read.tree("sample_20_comb0.10.9seqstr_tree.txt")
a3_20_8 <- read.tree("sample_20_comb0.20.8seqstr_tree.txt")
a3_30_7 <- read.tree("sample_20_comb0.30.7seqstr_tree.txt")
a3_40_6 <- read.tree("sample_20_comb0.40.6seqstr_tree.txt")
a3_50_5 <- read.tree("sample_20_comb0.50.5seqstr_tree.txt")
a3_60_4 <- read.tree("sample_20_comb0.60.4seqstr_tree.txt")
a3_70_3 <- read.tree("sample_20_comb0.70.3seqstr_tree.txt")
a3_80_2 <- read.tree("sample_20_comb0.80.2seqstr_tree.txt")
a3_90_1 <- read.tree("sample_20_comb0.90.1seqstr_tree.txt")
a3_ss <- read.tree("sample_20_seq_str_tree.txt")
a3_seq <- read.tree("sample_20_seq_tree.txt")
a3_str <- read.tree("sample_20_str_tree.txt")
trees <- c(aim1, aim2_all, aim2_jgi, a3_10_9, a3_20_8, a3_30_7, a3_40_6, a3_50_5, a3_60_4, a3_70_3, a3_80_2, a3_90_1, a3_ss, a3_seq, a3_str)
# normalize = pmax.int normalizes against the number of splits in the most resolved tree; in this case, JGI
all_nyes <- NyeSimilarity(jgi, trees, normalize = pmax.int)
##### Nye similarity scores #####
#
# Nye similarity is a generalized Robinson-Foulds metric. It finds the optimal matching that pairs each branch
# from one tree with a branch in the second and scores matches according to the size of the largest split that is
# consistent with both of them. It is then normalized against the Jaccard index.
#
# Since the following scores are similarity scores, they range from 0-1 with 1 being a perfect match.
#
# Aim 1: 0.6906
# Aim 2 (both): 0.8417
#
# ----- Aim 3 -----
# 10-90: 0.6281
# 20-80: 0.6235
# 30-70: 0.6593
# 40-60: 0.6702
# 50-50: 0.6702
# 60-40: 0.6702
# 70-30: 0.6760
# 80-20: 0.6702
# 90-10: 0.6702
# seq_str: 0.6702
# seq: 0.6702
# str: 0.6082
library(ape)
jgi <- read.tree("JGItree.nwk")
tip_labels <- jgi$tip.label
df <- data.frame(tips = tip_labels)
write.csv(df, "edit_tips.csv", quote = FALSE)
get_tips <- function(fin, fout) {
tree <- read.tree(fin)
tip_labels <- tree$tip.label
df <- data.frame(tips = tip_labels)
write.csv(df, fout, quote = FALSE, row.names = FALSE)
}
get_tips("jgi_modded_alltips.txt", "jgi_tips.csv")
library(ape)
get_tips <- function(fin, fout) {
tree <- read.tree(fin)
tip_labels <- tree$tip.label
df <- data.frame(tips = tip_labels)
write.csv(df, fout, quote = FALSE, row.names = FALSE)
}
get_tips("jgi_modded_alltips.txt", "jgi_tips.csv")
get_tips("li_alltips.nwk", "li_tips.csv")
get_tips <- function(fin, fout) {
tree <- read.tree(fin)
tip_labels <- tree$tip.label
df <- data.frame(tips = tip_labels)
write.csv(df, fout, quote = FALSE, row.names = FALSE)
}
get_tips("JGItree.nwk", "jgi_tips.csv")
get_tips("li_alltips.nwk", "li_tips.csv")
get_tips <- function(fin, fout) {
tree <- read.tree(fin)
tip_labels <- tree$tip.label
df <- data.frame(tips = tip_labels)
write.csv(df, fout, quote = FALSE, row.names = FALSE, col.names = FALSE)
}
get_tips("JGItree.nwk", "jgi_tips.csv")
get_tips("li_alltips.nwk", "li_tips.csv")
get_tips <- function(fin, fout) {
tree <- read.tree(fin)
tip_labels <- tree$tip.label
df <- data.frame(tips = tip_labels)
write.table(df, file = fout, sep = "\n", quote = FALSE, row.names = FALSE, col.names = FALSE)
}
get_tips("JGItree.nwk", "jgi_tips.csv")
get_tips("li_alltips.nwk", "li_tips.csv")
get_tips <- function(fin, fout) {
tree <- read.tree(fin)
tip_labels <- tree$tip.label
df <- data.frame(tips = tip_labels)
write.table(df, file = fout, sep = "\n", quote = FALSE, row.names = FALSE, col.names = FALSE)
return(tree)
}
jgi <- get_tips("jgi_modded_alltips.txt", "jgi_tips.csv")
li <- get_tips("li_alltips.nwk", "li_tips.csv")
jgi_tips <- c("Acain1", "Acema1", "Amphiamblys_sp.", "Armga1", "Armost1", "Arnium", "Arxula", "Ascni1", "Aspacu1", "Aspbru1", "Aspcos1", "Aspell1", "Aspergillus_nomius3137_1", "Aspeuc1", "Aspfij1", "Asphet1", "Asphom1", "Aspibe1", "Aspind1", "Aspjap1", "Asplac1", "Aspneo1", "Asppip1", "Asppseute1", "Aspsac1", "Aspscl1", "Aspscle1", "Aspuva1", "Aspvad1", "Aspvio1", "Bimnz1", "Biscogniauxia_sp.", "Cadophora_sp.", "Cadophora_sp.", "Canmem1", "CerAGI", "Cersp1", "Chaetomium_sp.", "Chytriomyces_sp.", "Cladorrhinum_sp.", "Cladorrhinum_sp.", "Coniochaeta_sp.", "Copmar1", "Copmic2", "Coprinopsis_sp.", "Copromyces_sp.", "Cordyceps_sp.", "Crycu1", "Cryte1", "Daldinia_sp.", "Decga1", "Densp1", "Diohu1", "Emericellopsis_sp.", "Endogone_sp", "Erebi1", "Fennellomyces_sp.", "FoxFo5176", "FoxII5", "Fusarium_oxysporum_2", "Fusarium_sp.", "Ganoderma_sp.", "Haplosporangium_sp.", "Haplosporangium_sp.", "Haplosporangium_sp.", "Helsul1", "Hydru2", "Hypoxylon_sp.", "Hypoxylon_sp.", "Hypoxylon_sp.", "Hypoxylon_sp.", "Hypoxylon_sp.", "Hypoxylon_sp.", "Hypoxylon_sp.", "Hypoxylon_sp.", "Hypoxylon_sp.", "Hypoxylon_sp.", "Ilyonectria_sp.", "Ilyonectria_sp.", "Jamsp1", "Lachancea_sp.", "Lacqui1", "Lactifluus_cf.", "Lactifluus_cf.", "Leisp1", "Leotiomycetes_sp.", "Leotiomycetes_sp.", "Leptodontidium_sp.", "Linin1", "Lizem1", "Marfi1", "Maseb1", "Meimi1", "MicG_I_3", "Micmi1", "Morhum1", "Morimp1", "Mortierella_sp.", "Mortierella_sp.", "Mortierella_sp.", "Mortierella_sp.", "Mortierella_sp.", "Mortierella_sp.", "Mortierella_sp.", "Mortierella_sp.", "Mortierella_sp.", "Mortierella_sp.", "Mortierella_sp.", "Mortierella_sp.", "Mortierella_sp.", "Mortierella_sp.", "Mortierella_sp.", "Mycgal1", "Mycosphaerella", "Mytre1", "Nemania_sp.", "Nemania_sp.", "Nemania_sp.", "Orpinomyces_sp.", "Panru1", "Paxam1", "Pecoramyces_sp.", "Peniophora_sp.", "Perma1", "Pestalotiopsis_sp.", "Phlebopus_sp.", "Phyllosticta_sp.", "Piromyces_sp.", "Pisolithus_sp.", "Pleery1", "Plucer1", "Podospora_aff.", "Polbr1", "Pseudogymnoascus_sp.", "Pseudogymnoascus_sp.", "Pseudogymnoascus_sp.", "Pseudogymnoascus_sp.", "Pseudogymnoascus_sp.", "Pseudogymnoascus_sp.", "Pyrenochaeta_sp.", "Rachicladosporium_sp.", "Rhexocercosporidium_sp.", "Rhihy1", "Rhiir2_1", "RhiirA1_1", "RhiirB3", "RhiirC2", "Rhili1", "Rhodotorula_sp.", "Rhodotorula_sp.", "Rhodsp1", "Ricmel1", "Saccharomycetaceae_sp", "Setho1", "Sistotrema_sp.", "Sorhu1", "Stagonospora_sp.", "Suidec1", "Suigr1", "Suihi1", "Suillus_cf.", "Synps1", "Terbo2", "Termitomyces_sp.", "Tescy1", "Thasp1", "Thega1", "Tilwa1", "Trace1", "Traci1", "Tribi1", "Tubbor1", "Umbelopsis_sp.", "Umbra1", "Ustsp1", "Xerba1", "Xylaria_cf.", "Xylaria_cf.", "Xylaria_sp.", "Xylaria_sp.", "Xylaria_sp.", "Xylaria_sp.", "Xylaria_sp.", "Xylaria_sp.", "Xylariaceae_sp.", "Xylariaceae_sp.", "Xylariaceae_sp.", "Xylariaceae_sp.", "Xylariaceae_sp.", "Xylariaceae_sp.", "Xylariaceae_sp.", "Xylariaceae_sp.", "Xylariaceae_sp.", "Xylariales_sp.", "Xylariomycetidae_sp.", "Xylariomycetidae_sp.", "Yarrowia_lipolytica_1", "Gelatoporia")
li_tips <- c("Gaeumannomyces_sp._JS-464", "Magnaporthe_sp._MG12", "Magnaporthe_sp._MG03", "Magnaporthe_sp._MG07", "Magnaporthe_sp._MG05", "Magnaporthe_sp._MG08", "Raffaelea_sp._RL272", "Juglanconis_sp._DMW523", "Nectria_sp._B-13", "Fusarium_sp._FIESC_12", "Fusarium_sp._FIESC_28", "Fusarium_sp._JS626", "Fusarium_sp._Na10", "Fusarium_sp._FSSC_6", "Fusarium_sp._JS1030", "Epichloe_sp._AL9924", "Tolypocladium_sp._Salcha_MEA-2", "Tolypocladium_sp._Sup5_PDA-1", "Ophiocordyceps_sp._camponoti-leonardi", "Ophiocordyceps_sp._camponoti-saundersi", "Cordyceps_sp._RAO-2017", "Lecanicillium_sp._MT-2017a", "Lecanicillium_sp._LEC01", "Escovopsis_sp._AC", "Escovopsis_sp._Ae724", "Escovopsis_sp._Ae720", "Escovopsis_sp._Ae733", "Escovopsis_sp._TC", "Colletotrichum_sp._JS-367", "Xylaria_sp._MSU_SB201401", "Xylaria_sp._JS573", "Hypoxylon_sp._EC38", "Hypoxylon_sp._CO27-5", "Hypoxylon_sp._E7406B", "Daldinia_sp._EC12", "Hypoxylon_sp._CI-4A", "Pestalotiopsis_sp._JCM_9685", "Cadophora_sp._DSE1049", "Helotiales_sp._F229", "Phialophora_cf._hyalina_BP_5553", "Rutstroemia_sp._NJR-2017a_BBW", "Rutstroemia_sp._NJR-2017a_WRK4", "Rutstroemia_sp._NJR-2017a_BVV2", "Pseudogymnoascus_sp._VKM_F-4515_FW-2607", "Pseudogymnoascus_sp._VKM_F-4517_FW-2822", "Pseudogymnoascus_sp._BL308", "Pseudogymnoascus_sp._23342-1-I1", "Pseudogymnoascus_sp._VKM_F-4520_FW-2644", "Pseudogymnoascus_sp._VKM_F-4518_FW-2643", "Pseudogymnoascus_sp._VKM_F-4281_FW-2241", "Pseudogymnoascus_sp._04NY16", "Pseudogymnoascus_sp._24MN13", "Pseudogymnoascus_sp._VKM_F-103", "Pseudogymnoascus_sp._VKM_F-4519_FW-2642", "Pseudogymnoascus_sp._05NY08", "Pseudogymnoascus_sp._03VT05", "Pseudogymnoascus_sp._WSF_3629", "Pseudogymnoascus_sp._VKM_F-4513_FW-928", "Pseudogymnoascus_sp._VKM_F-4246", "Pseudogymnoascus_sp._BL549", "Pseudogymnoascus_sp._VKM_F-3775", "Pseudogymnoascus_sp._VKM_F-4516_FW-969", "Pseudogymnoascus_sp._VKM_F-4514_FW-929", "Pseudogymnoascus_sp._VKM_F-3557", "Pseudogymnoascus_sp._VKM_F-3808", "Wickerhamomyces_sp._YB_2243", "Crepidotus_sp._BD2015", "Tricholoma_sp._MG99", "Tricholoma_sp._MG77", "Termitomyces_sp._MG16", "Termitomyces_sp._MG148", "Termitomyces_sp._J132", "Termitomyces_sp._MG145", "Termitomyces_sp._JCM_13351", "Collybia_sp._MG36", "Leucoagaricus_sp._SymC.cos", "Agaricales_sp._HM26F1", "Fibularhizoctonia_sp._CBS_109695", "Boletus_sp._MG95", "Boletus_sp._MG55", "Suillus_sp._MG131", "Rhizopogon_sp._AM2018a", "Ganoderma_sp._BRIUMSc", "Trametes_sp._AH282", "Sarcodon_sp._MG97", "Lactarius_sp._MG50", "Russula_sp._MG48", "Lactarius_sp._MG121", "Peniophora_sp._CONT", "Peniophora_sp._CBMAI_1063", "Dentipellis_sp._KUC8613", "Albatrellus_sp._MG142", "Ramaria_sp._MG151", "Gomphus_sp._MG54", "Ramaria_cf._rubripermanens", "Cryptococcus_cf._gattii", "Cryptococcus_sp._DSM_27421", "Cryptococcus_sp._JCM_24511", "Pseudozyma_sp._F8B2", "Moesziomyces_sp._F16C1", "Moesziomyces_sp._F5C1", "Malassezia_sp.", "Moniliella_sp._wahieum", "Rhodotorula_sp._CCFEE_5036", "Rhodotorula_sp._JG1b", "Rhodotorula_sp._FNED722", "Gongronella_sp._w5", "Endogone_sp._FLASF59071", "Rhizophagus_sp._MUCL_43196", "Zoopage_sp._CTAll", "Ichthyosporea_sp._XGB_2017a", "Nematocida_sp._ERTm5", "Nematocida_sp._1", "Amphiamblys_sp._WSBS2006", "Spizellomyces_sp._palustris", "Piromyces_sp._E2", "Curvularia_sp._IFB-Z10", "Pyrenochaeta_sp._DS3sAY3a", "Pyrenochaeta_sp._UM_256", "Shiraia_sp._slf14", "Paraphoma_sp._B47-9", "Pleosporales_sp._UM_1110_2012", "Stagonospora_sp._SRC1lsM3a", "Rachicladosporium_sp._CCFEE_5018", "Cladosporium_sp._SL-16", "Preussia_sp._BSL10", "Mycosphaerella_sp._PB-2012b", "Mycosphaerella_sp._Ston1", "Cercospora_cf._sigesbeckiae", "Aureobasidium_sp._FSWF8-4", "Eurotiomycetes_sp.", "Herpotrichiellaceae_sp._UM238", "Blastomyces_sp._MA-2018", "Emmonsia_sp._CAC-2015a", "Byssochlamys_sp._BYSS01", "Aspergillus_sp._Z5", "Aspergillus_sp._MA_6037", "Eurotiomycetes_sp._MA_6039", "Eurotiomycetes_sp._MA_6038", "Penicillium_sp._MA_6040", "Penicillium_sp._HKF2", "Penicillium_sp._CF05", "Penicillium_sp._MA_6036", "Byssochlamys_sp._AF001")
prune_tips <- function(tree, tips, fout) {
new_tree <- drop.tip(tree, tips)
write.tree(new_tree, fout)
}
prune_tips(jgi, jgi_tips, "jgi_half_pruned.txt")
prune_tips(li, li_tips, "Lietal_2021.nwk")
NyeSimilarity(jgi, li, normalize = pmax.int)
library(TreeDist)
NyeSimilarity(jgi, li, normalize = pmax.int)
# Get tip labels for all trees
jgi_labels <- jgi$tip.label
# Read in reference trees
jgi <- read.tree("JGItree.nwk")
li <- read.tree("Lietal_2021.nwk")
# Get tip labels for all trees
jgi_labels <- jgi$tip.label
li_labels <- li$tip.label
rm(li_tips)
rm(jgi_tips)
in_common <- intersect(li_labels, jgi_labels)
li <- keep.tip(li, in_common)
jgi <- keep.tip(jgi, in_common)
NyeSimilarity(jgi, li, normalize = pmax.int)
write.tree(li, "li_common.nwk")
write.tree(jgi, "jgi_common.nwk")
